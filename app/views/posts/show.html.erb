<p>
  <strong>Title:</strong> 
  <%= @post.title %>
</p>

<p>
  <strong>Details:</strong>
  <%= @post.content %>
</p>

<p>
  <strong>Tags:</strong>
  <%= @post.tags %>
</p>
  
<p>
  <strong>Posted by:</strong>
  <%= @user %>
</p>

<p>
  <strong>Posted at: </strong>
  <%= @post.created_at.strftime("%A, %B %e, %Y")%> at <%= @post.created_at.strftime("%I:%M %P") %>
</p>

<div class="d-flex">
  <% if @post.user_id == current_user.id || current_user.role == 'admin' || current_user.role == 'moderator' %>
    <div>
      <%= link_to 'Edit', edit_post_path(@post), class:"btn btn-primary" %>
    </div>

    <div id="right-div">
      <%= link_to 'Destroy', @post, method: :delete, data: { confirm: 'Are you sure?' }, class:"btn btn-danger"%>
    </div>
   <% end %>

  <div id="right-div">
    <%= link_to 'Back to Posts', posts_path, class:"btn btn-primary" %>
  </div>

</div>


<% unless @post.user_id == current_user.id %>
  <div class=d-flex>
    <div id="right-div">
      <%= link_to 'Up vote', class:"btn btn-success" %>
    </div>

    <div id="right-div">
       <%= link_to 'Down vote', class:"btn btn-danger" %>
    </div>
  </div>
<% end %> 

<hr class="bg-dark border-1 border-top border-success">
<br>

<h4>
  <%= pluralize(@post.comments.count, "Comment") %>
</h4>
<br>

<div class="container">
<% @post.comments.reverse.each do |comment| %>
  <hr>

  <div class="container"> 
    <%= comment.body %> ~ <b>@</b><%= comment.user.email.split('@')[0] %>
    <%= comment.created_at.strftime("%B %e, %Y") %> at <%= comment.created_at.strftime("%I:%M %P") %>

    <br>
    
    <% if current_user.id == comment.user_id %>
      <%= link_to 'Edit', edit_post_comment_path(comment) %>
      <%= link_to 'Delete', [comment.post, comment], method: :delete, class: "delete", data: { confirm: "Are you sure?" } %>
    <% end %>
  </div>

  <hr> 

<% end %>
</div>

<div class="container">
  <h5>Add a comment<h5>

  <%= render 'comments/form' %>
  
</div>

<hr>
<br/>

<h4>
  <%= pluralize(@post.answers.count, "Answer") %>
</h4> 

<div class="container">
  <% @post.answers.reverse.each do |answer| %>
    <br>
    <div class="card">
      <div class="container">
        <%= answer.content %>
        <hr>
        ~ <b>@</b><%= User.find_by(:id => answer.post.user_id).email %>
        <%= answer.created_at.strftime("%B %e, %Y") %> at <%= answer.created_at.strftime("%I:%M %P") %>

          <div class="bottom-corner">
            <% if current_user.id == answer.user_id %>
              <%= link_to 'Edit', edit_post_answer_path(answer) %>
              <%= link_to 'Delete', [answer.post, answer], method: :delete, class: "delete", data: { confirm: "Are you sure?" } %>
            <% end %>
            
            <% if @post.user_id == current_user.id%>+
              <%= link_to accept_answer(@post), accept_answer_post_path(@post), :remote => true, :id => "approve_link_#{@post.id}" %>
            <% end %> 
          </div>
      </div>
    </div>

    <br>
  <% end %>

</div>

<br>

<h4>Your answer</h4>

<% if @post.user_id == current_user.id %>

  <% if Time.now - @post.created_at >= 1.day %>

    <%= render 'answers/form' %>

  <% else %>

      <p> Users can answer their own questions only after <b>24 hours.</b> </p>
  
  <%end%>

<% else %>

  <%= render 'answers/form' %>

<% end %>